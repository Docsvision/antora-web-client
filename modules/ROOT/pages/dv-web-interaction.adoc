= Взаимодействие {wc}а с DVWebTool (DVSupService)

* _DVWebTool_ и _DVSupService_ выполняются на пользовательском компьютере и предоставляют возможность запускать определённые процессы с правами *текущего пользователя*.
** _DVWebTool_ предоставляет {wc}у доступ к окружению пользователя: установленным программам, локальным и сетевым устройствам.
+
_DVWebTool_ будет использоваться, если компьютер пользователя работает под управлением ОС Windows. Инсталлятор которой будет скачан и запущен автоматически. Установка и запуск _DVWebTool_ описаны в разделе "xref:user:prepare-add-components.adoc#dvWebTool[Установка и запуск программы DVWebTool]".
** _DVSupService_ предоставляет {wc}у доступ к окружению пользователя: установленным программам.
+
_DVSupService_ будет использоваться, если компьютер пользователя работает под управлением ОС Linux. Установка и запуск _DVSupService_ описаны в разделе "xref:user:prepare-add-components.adoc#dvSupService[Установка и запуск службы DVSupService]".

[NOTE]
====
* {blank}
include::ROOT:partial$excerpts.adoc[tags=dv-web-launch]
* _DVSupService_ запускается от имени суперпользователя. Если на компьютере работает несколько пользователей, службу нужно установить один раз.
====

.Взаимодействие компонентов организовано следующим образом:
. Пользователь {wc}а инициирует операцию, требующую запуска процессов на компьютере пользователя. Например, вызов офисного приложения для автоконсолидации версий документа.
. Веб-браузер пользователя подключается по локальному адресу к порту `5413`, который по умолчанию прослушивает программа _DVWebTool_. Подключение осуществляется по протоколу `WebSocket`.
. Веб-браузер вызывает требуемую функцию программы _DVWebTool_. Например, запускает офисное приложение в режиме автоконсолидации документа.
. Программа _DVWebTool_ выполняет требуемую задачу -- открывает офисное приложение, используемое по умолчанию.

.Схема взаимодействия программы DVWebTool с другими компонентами
image::dv-web-tool-schema.png[Схема взаимодействия программы DVWebTool с другими компонентами]

Программа _DVWebTool_ обеспечивает базовые функции взаимодействия с веб-браузером, функции для работы с окружением реализованы в расширениях программы. Расширения _DVWebTool_ могут вызывать функции программ с компьютера пользователя или устройств. Расширения _DVWebTool_ могут также выполнять другие операции, например, взаимодействовать с сетевыми ресурсами. Для реализации новых функций могут быть разработаны собственные расширения.

// [#consolidation]
// == Алгоритм работы при создании объединенной версии согласуемого документа
//
// Указанный далее алгоритм описывает механизм создания объединенной версии согласуемого документа при вызове данной функции пользователем.
//
// . Из клиентской части {wc}а в программу _DVWebTool_ передается идентификатор карточки для консолидации.
// . Программа _DVWebTool_ получает с сервера файлы для консолидации и средствами офисного приложения выполняет слияние файлов. Результат передается на сервер.
//
// NOTE: Для работы данного алгоритма важно, чтобы {wc} и программа _DVWebTool_ были запущены от имени одного сотрудника.
//
// [#scan]
// == Алгоритм работы при сканировании
//
// . Из клиентской части {wc}а в программу _DVWebTool_ передается запрос на сканирование с параметрами сканирования.
// . Программа _DVWebTool_ обращается к сканеру, получает с него результат и передаёт клиенту.

[#launch]
== Поведение при запуске

По умолчанию программа запускается при запуске системы и не закрывается после выполнения действия. Данное поведение можно изменить, см. "xref:admin:webservices-launch.adoc[]".
