= Комментарии

Элемент управления `_Комментарии_` предназначен для просмотра и добавления комментариев в карточке.

.Элемент управления "Комментарии" в разметке карточки
image::comments.png[Элемент управления "Комментарии" в разметке карточки]

ЭУ может быть добавлен в разметку просмотра или редактирования.

Пользователь может добавлять новые комментарии, изменять и удалять существующие (собственные и чужие) при наличии прав на данные операции по ролевой модели безопасности. Собственные комментарии отображаются с правой стороны, чужие -- с левой.

При наличии прав на операции, над строкой комментария отображаются кнопки изменения и удаления. Если настроено ограничение на количество отображаемых комментариев, над списком может отображаться ссылка для показа всех комментариев с указанием количества скрытых комментариев.

Комментарии сортируются по порядку добавления. Автоматическое обновление списка комментариев не предусмотрено.

== Свойства

include::partial$properties.adoc[tags=general]

=== Внешний вид

==== Заполнитель

Текст, отображаемый в поле для ввода комментария.

`*Локализуемый*`

==== Ширина блока комментария

Определяет ширину блока, в котором отображается отдельный комментарий, относительно ширины элемента управления. Используется для визуального разделения своих и чужих комментариев. Ширина по умолчанию -- 80%.

=== Данные

==== Источник данных

Выбор секции и полей карточки с комментариями из данной или связанной карточки. Настройка осуществляется в форме, открываемой при нажатии кнопки image:buttons/three-dots.png[Три точки]:

.Окно настройки источника данных с комментариями
image::comments-source-config.png[Окно настройки источника данных с комментариями]

.Настройки источника содержат следующие элементы:
* _Секция_ -- выбор секции с данными комментариев. Если к разметке подключены дополнительные источники данных, для выбора будут доступны секции карточки и дополнительных источников.
* _Поле автора_, _Поле даты_ и _Поле комментария_ -- выбор полей из выбранной секции, содержащих соответствующие секции.

=== Поведение

include::partial$properties.adoc[tags=visibility]

==== Добавление комментария

Выбор операции редактирования, которая должна быть доступна пользователю, для разрешения добавления комментариев. Если операция не выбрана, добавление комментариев разрешено.

include::partial$properties.adoc[tags=addCss]

==== Изменение всех комментариев

Операция редактирования, которая определяет разрешения пользователя на изменение/удаление чужих и собственных комментариев. Если операция не выбрана, изменение/удаление чужих и собственных комментариев разрешено.

==== Изменение только своих комментариев

Операция редактирования, которая определяет разрешения пользователя на изменение/удаление собственных комментариев. Если операция не выбрана и/или доступна операция редактирования всех комментариев, изменение/удаление собственных комментариев разрешено.

[#html]
==== Использовать HTML редактор

// Свойство доступно для включения, только если в Панели управления {wc}ом включена экспериментальная функция xref:admin:.experiment-comments.adoc[Контрол комментарии с html редактором].
При включении данное свойство позволяет упоминать сотрудников в комментариях и форматировать текст комментария в процессе ввода.

==== Количество отображаемых комментариев

Максимальное количество (последних) отображаемых в списке комментариев. Если комментариев больше указанного числа, в ЭУ будет показана ссылка для показа всех комментариев.

include::partial$properties.adoc[tags=editOperationForVisibility]

include::partial$properties.adoc[tags=disabled]

include::partial$properties.adoc[tags=byTab]

include::partial$properties.adoc[tags=stdCss]

=== События

==== Перед добавлением комментария

Вызывается перед сохранением нового комментария.

==== Перед редактированием комментария

Вызывается перед сохранением изменений комментария.

==== Перед удалением комментария

Вызывается перед удалением комментария.

include::partial$properties.adoc[tags=dataChanged]

==== При добавлении комментария

Вызывается после добавления комментария.

include::partial$properties.adoc[tags=mouseOver]

include::partial$properties.adoc[tags=mouseAway]

include::partial$properties.adoc[tags=focusGet]

include::partial$properties.adoc[tags=focusLoose]

==== При редактировании комментария

Вызывается после изменения комментария.

==== При удалении комментария

Вызывается после удаления комментария.

include::partial$properties.adoc[tags=onClick]
