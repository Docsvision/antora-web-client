= Работа с файлами согласования

== Ознакомиться с составом согласуемых и дополнительных файлов

Согласуемыми файлами являются основные файлы согласуемой карточки Документ. Дополнительные файлы не участвуют в процессе согласования и могут быть приложены к документу только для ознакомления.

.Чтобы ознакомиться с файлами в задании на согласование:
. Откройте карточку полученного задания на согласование.
. Ознакомьтесь с текущими версиями согласуемых файлов, представленных в разделе _Файлы для согласования_.
+
При необходимости ознакомьтесь с версиями, созданными в процессе согласования, и выполните доступные операции с файлами, поступившими на согласование: просмотрите список доступных версий, создайте собственную версию или комментарий к версии.
+
Файлы, представленные в списке _Дополнительные файлы_, являются дополнительными файлами согласуемого документа, и не участвуют в согласовании, но могут быть полезны при принятии решения.
+
.Список файлов для согласования в карточке задания "На согласование"
image::approval-view.png[Список файлов для согласования в карточке задания "На согласование"]

[#versioning-rules]
== Правила формирования версий файлов при согласовании

В процессе согласования к документу или заданию могут быть приложены собственные версии согласующих, добавленные загрузкой или изменённые через приложение, а также версии, созданные автоматически бизнес-процессом согласования. Версии формируются и учитываются отдельно для каждого приложенного файла.

При первичной загрузке _основного_ файла к карточке документа версии файла будет присвоен номер `в.1`. Наименование следующих версий может отличаться в зависимости от вида маршрута согласования.

[#regular]
=== Обычное согласование

.Создание исходной версии документа
image::approval-file-version1.png[Создание исходной версии документа]

После отправки документа по маршруту согласования, исполнители первого этапа получат для согласования копию версии файла `в.1` с названием `в.1.1`. Вторая цифра после точки будет соответствовать номеру этапа (в данном случае -- первому этапу).

Если на каком-либо этапе согласующий создаст собственную версию, её номер будет сформирован как `в.1.1.N`. `N` -- порядковый номер версии, созданной данным согласующим. Первая созданная версия будет `в.1.1.1`, следующая -- `в.1.1.2` и так далее.

Если в этапе участвуют два согласующих, и второй согласующий создаст собственную версию, её номер версии будет образован как `номер версии предыдущего согласующего + 1`. Например, `в.1.1.2`.

При переходе к следующему этапу согласования данного маршрута, согласующему будет отправлена копия версии файла `в.1` с названием `в.1.2.N`. Соответственно, нумерация версий согласующих будет выглядеть как: `в.1.2.N`.

Аналогичным образом будут формироваться версии всех последующих этапов согласования.

На втором цикле согласования исполнители первого этапа получат для согласования версию с названием `в.2.1`. Первая цифра соответствует номеру цикла, вторая -- номеру этапа. Аналогичным образом будут формироваться версии всех последующих циклов до наступления первого этапа xref:approval-users-consolidator.adoc[консолидации].

[#advanced]
=== Усовершенствованное согласование

.Версии файлов согласования
image::advanced-versions.png[Версии файлов согласования]

При усовершенствованном согласовании номера версий назначаются по порядку. Начальная версия имеет номер `в. 1`. Новая версия файла создаётся, только если он был изменён. Следующая версия будет иметь вид `в. 2` и далее по порядку.

Номер версии не зависит от этапа или цикла. В списке версий отображаются все версии, созданные из этапа или прохода этого задания и исходная версия этапа. Версии упорядочены в списке по порядку добавления. Первой отображается исходная версия этапа.

.Для всех версий доступны следующие операции:
* *Открыть*
* *Скачать*
* *Комментировать*

// права перетекают по операции _Операции согласования_
.Операции для версий, созданных из этого задания:
* *Удалить*.
* *Редактировать*.

[#viewVersions]
== Просмотреть версии согласуемых файлов

.Чтобы посмотреть список доступных версий файлов на согласовании:
. Откройте карточку задания на согласование.
. Перейдите к разделу _Файлы для согласования_.
+
.Файлы для согласования
image::approval-file-versions.png[Файлы для согласования]
+
. Нажмите на согласуемый файл, чтобы раскрыть список доступных версий файла.
+
.Текущая версия файла выделяется жирным шрифтом
image::approval-file-versions-list.png[Текущая версия файла выделяется жирным шрифтом]
+
****
Подробнее о формировании номера версии см. <<versioning-rules,выше>>. В описании версии будет отображаться дата и время добавления версии.
****

[#add-version]
== Создать новую версию согласуемого файла

.Для создания собственной версии согласуемого файла, выполните следующие действия:
. Откройте карточку согласуемого документа.
. В разделе *Файлы для согласования* выберите <<viewVersions,версию>>, на основе которой требуется создать собственную версию файла.
. Нажмите image:buttons/vertical-dots.png[Три вертикальные точки] справа от названия файла и выберите команду *Скачать версию*, чтобы сохранить файл на компьютер.
. Создайте новую версию файла одним из доступных способов:
+
* Нажмите кнопку *Скачать версию*, чтобы загрузить версию себе на компьютер и создать новую версию на основе существующей.
+
.Команда скачивания версии в контекстном меню версии файла
image::save-version.png[Команда скачивания версии в контекстном меню версии файла]
+
* Нажмите кнопку *Открыть*, чтобы открыть версию на редактирование в офисном редакторе. Потребуется DVWebTool или DVSupService, см. подробнее "xref:prepare-add-components.adoc#dvWebTool[Установка и запуск программы DVWebTool]" или "xref:prepare-add-components.adoc#dvSupService[Установка и запуск службы DVSupService]".
+
. Внесите требуемые изменения в файл.
. Сохраните изменения в файле.
+
* Если версия была скачана на устройство, после сохранения изменений нажмите кнопку image:buttons/vertical-dots.png[Три вертикальные точки] справа от названия (не версии) согласуемого файла и выберите команду *Загрузить версию*. Затем выберите загружаемый файл с файловой системы.
+
.Команда загрузки версии в контекстном меню файла для согласования
image::load-new-version.png[Команда загрузки версии в контекстном меню файла для согласования]
+
****
Название загружаемого файла должно совпадать с названием файла, для которого загружается новая версия.

Новая версия файла будет добавлена в список.
****
+
* Если версия была открыта в офисном редакторе, новая версия будет автоматически создана в задании сразу после закрытия окна редактора.

[#add-comment]
== Оставить комментарий к версии файла

Согласующий может оставить комментарий к версии файла. Редактировать или удалять свой комментарий можно до появления нового комментария или до принятия решения по согласованию.

.Чтобы добавить комментарий:
. Откройте карточку задания на согласование.
. В разделе *Файлы для согласования* нажмите на номер версии и выберите версию файла, к которой требуется добавить комментарий.
. Выполните любое из действий:
+
* Нажмите на иконку image:buttons/comment.png[Комментарии] справа от названия файла. Иконка скрыта, если по данной версии нет комментариев;
* Нажмите image:buttons/vertical-dots.png[Три вертикальные точки] *> Комментировать*, чтобы открыть окно добавления комментария.
+
.Добавление комментария к версии согласуемого файла
image::approval-comment-version.png[Добавление комментария к версии согласуемого файла]
+
. Введите текст комментария и нажмите *Сохранить*, чтобы добавить комментарий к версии файла.
+
****
Чтобы посмотреть комментарии, нажмите image:buttons/comment.png[Комментарии]. Справа от кнопки отображается количество комментариев.
****
